# Generated by the J-Dek Project gem (0.3.24)

version: "3.9"

volumes:
  hass_config:

services:
  app:
    build:
      context: ..
      dockerfile: .devcontainer/Dockerfile
      args:
        # Update 'VARIANT' to pick a Python version
        VARIANT: "3.9"
        NODE_VERSION: "none"
    volumes:
      # Change to reflect the workspace directory
      - ..:/workspaces/hass_enhanced_dashboard
      # Shared HASS config
      - hass_config:/workspaces/hass_enhanced_dashboard/.hass_config
      # Map users settings
      - ~/.ssl:/.ssl/
      - ~/.ssh:/home/vscode/.ssh/
      - ~/.gitconfig:/home/vscode/.gitconfig
      - ~/.netrc:/home/vscode/.netrc
      # Allow XServer for WSLg
      - /tmp/.X11-unix:/tmp/.X11-unix
      - /mnt/wslg:/mnt/wslg
    # Keeps the server open
    tty: true
    links:
      - hass
    environment:
      # Allow XServer for WSLg
      - DISPLAY=:0
      - WAYLAND_DISPLAY
      - XDG_RUNTIME_DIR
      - PULSE_SERVER

  hass:
    image: ghcr.io/home-assistant/home-assistant:stable
    restart: unless-stopped
    volumes:
      # Shared HASS config
      - hass_config:/config
      # HASS projects
      - ../../hass_enhanced_dashboard/custom_components/enhanced_dashboard:/config/custom_components/enhanced_dashboard
      - ../../lovelace-compact-calendar-card/dist:/config/www/community/lovelace-compact-calendar-card
    environment:
      - TZ=America\Los_Angeles
    ports:
      - "8123:8123"
